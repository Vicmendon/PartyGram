{% load static %}

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmação de Presença - {{ evento.nome }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>body {
        background-color: #a3b18a50; /* Verde bosque suave */
        color: #333; /* Cor do texto (opcional) */
        font-family: Arial, sans-serif; /* Fonte padrão (opcional) */
    }</style>
</head>
<body class="">
    <div class="card text-bg-dark">
        <img src="{% static 'convidado/images/fundo-topo.png' %}"" alt="" class="card-img">
        <div class="card-img-overlay">
            <h2>{{ evento.nome }}</h2>
        </div>
    </div>

    <div class="container mt-4">
        <h1>Confirmação de Presença</h1>

        {% if mensagem %}
        <div class="alert alert-info">{{ mensagem }}</div>
        {% endif %}

        <form method="post">
            {% csrf_token %}
            <div class="row mb-3 align-items-center">
                {{ busca_form.nome.label_tag }}
                {{ busca_form.nome }}
            </div>
            <div class="row mb-3 align-items-center">
                {{ busca_form.telefone.label_tag }}
                {{ busca_form.telefone }}
            </div>
            <div class="row mb-3 align-items-center">
                <button type="submit" name="buscar" class="btn btn-primary">Pesquisar</button>
            </div>
            
        </form>

        {% if convidado %}
        <hr>
        <h3>Convite Encontrado</h3>

        <form method="post">
            {% csrf_token %}
            <table class="table">
                <thead class="bg-green">
                    <th>Convidado</th>
                    <th>Confirmar Presença</th>
                </thead>
                <tr class="table-secondary">
                    <td>{{ convidado.nome }} {{ convidado.sobrenome }}</td>
                    <td>
                        <input type="checkbox" name="convidado_rsvp_{{ convidado.id }}" id="sim_{{ convidado.id }}">
                    </td>
                </tr>
                {% for parente in parentes %}
                <tr class="table-secondary">
                    <td>{{ parente.nome }}</td>
                    <td>
                        <input type="checkbox" name="parente_rsvp_{{ parente.id }}" id="sim_{{ parente.id }}">
                    </td>
                </tr>
                {% endfor %}
            </table>

            <button type="submit" name="confirmar" class="btn btn-success">Confirmar</button>
        </form>


        <div class="container mt-5">
        <p><b>Data:</b> {{ evento.data }} <br><b>Local:</b> {{ evento.compl_endereco }}<br><b>Endereço:</b> {{ evento.endereco }}</p>
        

        <iframe width="100%" height="500" src="https://www.openstreetmap.org/export/embed.html?bbox=-43.05392861366273%2C-22.890406350467348%2C-43.04867148399354%2C-22.88829116951837&amp;layer=mapnik&amp;marker=-22.889348764113816%2C-43.051300048828125" style="border: 1px solid black"></iframe><br/><small><a href="https://www.openstreetmap.org/?mlat=-22.889349&amp;mlon=-43.051300#map=19/-22.889349/-43.051300">Ver mapa ampliado</a></small>
        </div>

        {% endif %}
        <hr>
    </div>


    <script>
        // Aguarda o DOM ser carregado
        document.addEventListener("DOMContentLoaded", function () {
            // Seleciona todos os checkboxes
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    
            // Adiciona o evento de clique para cada checkbox
            checkboxes.forEach((checkbox) => {
                checkbox.addEventListener("change", function () {
                    // Obtém o elemento <tr> pai do checkbox
                    const row = checkbox.closest("tr");
    
                    // Verifica se a linha foi encontrada
                    if (row) {
                        // Alterna as classes com base no estado do checkbox
                        if (checkbox.checked) {
                            row.classList.remove("table-danger");
                            row.classList.add("table-success");
                        } else  {
                            row.classList.remove("table-success");
                            row.classList.add("table-danger");
                        }
                    }
                });
            });
        });
    </script>
    
    
</body>
</html>
